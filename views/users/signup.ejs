<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />
  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
    crossorigin="anonymous"
  />
  <link
    href="http://localhost:3000/css/signup.css"
    rel="stylesheet"
    type="text/css"
  />

  <title>Sign up for Sweat</title>
  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
    }
  </style>
</head>

<body>
  <header></header>
  <div class="flash-messages">
    <% if(flashMessages) { %> <% if(flashMessages.success) { %>
    <div class="alert alert-success mb-0"><%= flashMessages.success %></div>
    <% }else if(flashMessages.error) { %>
    <div class="alert alert-danger mb-0"><%= flashMessages.error %></div>
    <% }else if(flashMessages.warning) { %>
    <div class="alert alert-warning mb-0"><%= flashMessages.warning %></div>
    <% } %> <% } %>
  </div>
  <div class="form-popup" id="app">
    <form action="/users/create" method="POST" class="form-container">
      <div class="container">
        <h1>Sign Up</h1>

        <p>Please fill out this form to create an account with Sweat.</p>
        <hr />
        <div class="form-group col">
          <div class="auto">
            <label for="txtFirstName"><b>First Name:*</b></label>
            <input
              id="txtFirstName"
              type="text"
              placeholder="First Name"
              name="firstName"
              required
            />
          </div>
        </div>
        <div class="form-group col">
          <div class="auto">
            <label for="txtLastName"><b>Last Name:*</b></label>
            <input
              id="txtLastName"
              type="text"
              placeholder="Last Name"
              name="lastName"
              required
            />
          </div>
        </div>

        <div class="form-group col">
          <div class="auto">
            <label for="txtUserName"><b>Username:*</b></label>
            <input
              id="txtUserName"
              type="text"
              placeholder="Username"
              name="username"
              required
            />
          </div>
        </div>

        <div class="form-group col">
          <div class="auto">
            <label for="txtDoB"><b>Date of birth:*</b></label>
            <input
              id="txtDoB"
              type="date"
              name="dob"
              required
              class="form-control"
              required
            />
          </div>
        </div>

        <div class="form-group col">
          <div class="auto">
            <label for="txtEmail"><b>Email:*</b></label>
            <input
              id="txtEmail"
              type="email"
              placeholder="Enter Email"
              name="email"
              required
            />
          </div>
        </div>

        <div class="form-group col">
          <div class="auto">
            <label for="txtConfirmEmail"><b>Confirm Email:*</b></label>
            <input
              id="txtConfirmEmail"
              type="email"
              placeholder="Confirm Email"
              name="confirmEmail"
              required
            />
          </div>
        </div>

        <div class="form-group col">
          <div class="auto">
            <label for="txtPassword"><b>Password:*</b></label>
            <input
              id="txtPassword"
              type="password"
              placeholder="Enter Password"
              name="password"
              required
            />
          </div>
        </div>

        <div class="form-group col">
          <div class="auto">
            <label for="txtConfirmPassword"><b>Confirm Password:*</b></label>
            <input
              id="txtConfirmPassword"
              type="password"
              placeholder="Confirm Password"
              name="confirmPassword"
              required
            />
          </div>
        </div>

        <div class="form-group col">
          <label><b>Gender:</b> </label>
          <div class="auto">
            <div class="form-check">
              <input
                type="radio"
                id="rbMale"
                name="gender"
                value="male"
                class="form-check-input"
              />
              <label for="rbMale" class="form-check-label"><b>Male</b></label>
            </div>
            <div class="form-check">
              <input
                type="radio"
                id="rbFemale"
                name="gender"
                value="female"
                class="form-check-input"
              />
              <label for="rbFemale" class="form-check-label"
                ><b>Female</b></label
              >
            </div>
            <div class="form-check">
              <input
                type="radio"
                id="rbOther"
                name="gender"
                value="other"
                class="form-check-input"
              />
              <label for="rbOther" class="form-check-label"><b>Other</b></label>
            </div>
          </div>
        </div>

        <div class="form-group col">
          <div class="auto">
            <label for="txtAddress" class="col-form-label">
              <b>Address:</b>
            </label>
            <div class="col auto">
              <input
                type="text"
                id="txtStreet"
                name="street"
                class="form-control"
                placeholder="Street"
              />
            </div>
            <div class="col auto">
              <input
                type="text"
                id="txtCity"
                name="city"
                class="form-control"
                placeholder="City"
              />
            </div>
            <div class="col auto">
              <input
                type="text"
                id="txtState"
                name="state"
                class="form-control"
                placeholder="State"
              />
            </div>
            <div class="col auto">
              <input
                type="text"
                id="txtZipcode"
                name="zipCode"
                class="form-control"
                placeholder="Zipcode"
                pattern="[0-9]{5}"
              />
            </div>
          </div>
        </div>
        <br />

        <div class="form-group col">
          <div class="auto">
            <label for="securityQuestions"><b>Security Questions:*</b></label>
            <select name="question" id="securityQuestions" required>
              <option value=""></option>
              <option value="What was your first place of employment?">
                What was your first place of employment?
              </option>
              <option value="What was your schools mascot?">
                What was your schools mascot?
              </option>
              <option value="What is your favorite team?">
                What is your favorite team?
              </option>
              <option value="What is your favorite workout?">
                What is your favorite workout?
              </option>
            </select>
            <br />
            <div class="col auto" name="answer" id="securityAnswer">
              <input
                type="text"
                id="securityAnswers"
                name="answer"
                class="form-control"
                placeholder="Answer"
                required
              />
            </div>
          </div>
        </div>

        <div class="form-group col">
          <div class="auto">
            <div class="col-25">
              <label for="txtBio"><b>About Me:</b></label>
            </div>
            <div class="col-95">
              <textarea
                id="txtBio"
                name="bio"
                rows="4"
                cols="50"
                class="form-control"
                placeholder="Tell us about yourself."
              ></textarea>
              <br /><br />
            </div>
          </div>
        </div>

        <label for="chkRemeber"
          ><b>Remember me:</b>
          <input
            id="chkRemeber"
            type="checkbox"
            checked="checked"
            name="chkRemember"
            style="margin-bottom: 15px"
        /></label>

        <p>
          By creating an account you agree to our
          <a href="#" style="color: #1427fe">Terms & Privacy</a>.
        </p>

        <div class="clearfix auto">
          <button type="submit" class="button">Sign Up</button>
          <button type="cancel" class="button cancel" onclick="goBack()">
            Close
          </button>
        </div>
      </div>
    </form>
  </div>

  <script
    src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"
  ></script>

  <script>
    function goBack() {
      window.history.back();
    }

    function checkForm(e) {
      this.errors = [];

      const passwordRules = [
        { message: "One lowercase letter required.", regex: /[a-z]+/ },
        { message: "One uppercase letter required.", regex: /[A-Z]+/ },
        { message: "One number required.", regex: /[0-9]+/ },
        { message: "3 characters minimum.", regex: /.{8,}/ },
      ];

      /*First Name*/
      if (!this.firstName) {
        this.errors.push("First Name required.");
        document.getElementsByName("firstName")[0].style.backgroundColor =
          "red";
      } else if (!this.vaildText(this.firstName)) {
        this.errors.push("Invalid characters in First Name.");
        document.getElementsByName("firstName")[0].style.backgroundColor =
          "red";
        return false;
      }
      /*Last Name*/
      if (!this.lastName) {
        this.errors.push("Last Name required.");
        document.getElementsByName("lastName")[0].style.backgroundColor = "red";
      } else if (!this.vaildText(this.lastName)) {
        this.errors.push("Invalid characters in Last Name.");
        document.getElementsByName("lastName")[0].style.backgroundColor = "red";
        return false;
      }
      /*Username*/
      if (!this.username) {
        this.errors.push("User Name required.");
        document.getElementsByName("username")[0].style.backgroundColor = "red";
      } else if (!this.vaildText(this.username)) {
        this.errors.push("Invalid characters in User Name.");
        document.getElementsByName("username")[0].style.backgroundColor = "red";
        return false;
      }
      /*Email
            if (!this.email) {
                this.errors.push('Email required.');
                document.getElementsByName("email")[0].style.backgroundColor = "red";
            } else if (!this.validEmail(this.email)) {
                this.errors.push('Valid email required.');
                document.getElementsByName("email")[0].style.backgroundColor = "red";
            }*/

      if (!this.confirmEmail) {
        this.errors.push("Please confirm email address.");
        document.getElementsByName("confirmEmail")[0].style.backgroundColor =
          "red";
      } else if (this.email != this.confirmEmail) {
        this.errors.push("Email and Email Confirmation do not match");
        document.getElementsByName("email")[0].style.backgroundColor = "red";
        document.getElementsByName("confirmEmail")[0].style.backgroundColor =
          "red";
        return false;
      }
      /*Password*/
      if (!this.password) {
        this.errors.push("Password required.");
        document.getElementsByName("password")[0].style.backgroundColor = "red";
      }
      if (!this.confirmPassword) {
        this.errors.push("Please confrim your password.");
        document.getElementsByName("confirmPassword")[0].style.backgroundColor =
          "red";
      } else if (this.password != this.confirmPassword) {
        alert("Password and Password confirmation do not match");
        document.getElementsByName("confirmPassword")[0].style.backgroundColor =
          "red";
        document.getElementsByName("password")[0].style.backgroundColor = "red";
        return false;
      } else {
        for (let condition of this.passwordRules) {
          if (!condition.regex.test(this.password)) {
            alert(condition.message);
            document.getElementsByName("password")[0].style.backgroundColor =
              "red";
            return false;
          }
        }
      }
      /*Address*/
      if (!this.vaildText(this.street)) {
        this.errors.push("Invalid characters in Street Address.");
        document.getElementsByName("street")[0].style.backgroundColor = "red";
        return false;
      }
      if (!this.vaildText(this.city)) {
        this.errors.push("Invalid characters in City field.");
        document.getElementsByName("city")[0].style.backgroundColor = "red";
        return false;
      }
      if (!this.vaildText(this.state)) {
        this.errors.push("Invalid characters in State field.");
        document.getElementsByName("state")[0].style.backgroundColor = "red";
        return false;
      }
      if (!this.vaildText(this.zipCode)) {
        this.errors.push("Invalid characters in Zipcode field.");
        document.getElementsByName("zipCode")[0].style.backgroundColor = "red";
        return false;
      }

      /*Security Question*/
      if (this.question == "") {
        this.errors.push("Security Question is required.");
        document.getElementsByName("question")[0].style.backgroundColor = "red";
        return false;
      }
      if (!this.answer) {
        this.errors.push("Security Answer is required.");
        document.getElementsByName("answer")[0].style.backgroundColor = "red";
      } else if (!this.vaildText(this.answer)) {
        this.errors.push("Invalid characters in Security field.");
        document.getElementsByName("answer")[0].style.backgroundColor = "red";
        return false;
      }

      /*Bio*/
      if (!this.vaildText(this.bio)) {
        this.errors.push("Invalid characters in Biography field.");
        document.getElementsByName("bio")[0].style.backgroundColor = "red";
        return false;
      }

      if (!this.errors.length) {
        return true; /*No ERRORS! WOW! SO COOL! YOUR GREAT!*/
      } else {
        return false;
      }
      e.preventDefault();
    }
    function vaildText(text) {
      var re = /[A-Za-z0-9 ._^%$!~@,]/g;
      return re.test(text);
    }
  </script>
</body>
